


# 																data-archiving

> 目前的功能比较少，后续还会迭代。

## 1. 订单表-归档接口：

> 根据传入的参数来迁移数据，比如传入的是 2024-5-30 17:02:37,那么将会对 2024年4月份的数据进行归档，默认每次归档500条数据，直至归档完成。
>
> 注：此接口调用前先把项目.yml的lastProcessedId值改为被归档的月份的数据的起始id。其他参数可以根据实际情况来选择是否更改。
>
> ```
> # 自定义配置-切表配置
> data-archiving:
>     lastProcessedId: 200001 #  切表的起始位置，第一次切表先去数据库里面起始位置的id值
>     maxBatchSize: 500 # 每次切500条数据
>     archiveTablePrefix: order_info # 切分后的表名称前缀
>     oldTableName: order_info # 被切分的原始表名称
> ```

### 接口类型：POST

### 接口路径：http://127.0.0.1:8081/archiveOrders/start

### 请求参数示例：

|名称|值|类型|必选|说明|
|---|---|---|---|---|
|dataMonth|2024-5-1 12:23:21|string| 是 |归档的数据所属月份，即对5月份的数据进行归档|

### 成功示例：

```json
{
    月份为：2024-5-1 12:23:21 的归档任务已完成！
}
```

### 失败示例：

```json
{
	错误：无法解析日期 XXXXX，请确保格式正确（格式应为 yyyy-M-d HH:mm:ss）！
}
```

```json
{
    "错误：服务器内部错误，归档失败！"
}
```





## 2. 插入数据接口

> 根据请求参数来插，传入的是创建时间是 几月份就生成几月份的数据，默认一次生成10w条。

### 接口类型：GET

### 请求路径： http://127.0.0.1:8081/InsertDatasToOrderInfo/insertByTime

### 请求参数示例：

| 名称       | 值                | 类型   | 必选 | 说明     |
| ---------- | ----------------- | ------ | ---- | -------- |
| createTime | 2024-6-5 22:00:05 | string | 是   | 创建时间 |
| updateTime | 2024-6-5 22:00:05 | string | 是   | 更新时间 |

### 成功示例：

```json
{
    插入10w条数据成功（根据传入的时间戳插入订单数据）
}
```

### 失败示例:

```json
{
    "插入10w条数据成功（根据传入的时间戳插入订单数据）"
}
```





